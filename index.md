# Prisma ã‚’ã¯ã˜ã‚ã‚‹

Welcome ðŸ‘‹

ãƒ‡ãƒ¼ã‚¿é§†å‹•åž‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ§‹ç¯‰ã¨æ‹¡å¼µã‚’å®¹æ˜“ã«ã™ã‚‹å½“ç¤¾ã®è£½å“ã‚’ã”è¦§ãã ã•ã„ã€‚

`Prisma ORM` ã¯ã€æ¬¡ä¸–ä»£ã® Node.js ãŠã‚ˆã³ TypeScript ORM ã§ã€ç›´æ„Ÿçš„ãªãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ã€è‡ªå‹•ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€åž‹å®‰å…¨æ€§ã€è‡ªå‹•è£œå®Œæ©Ÿèƒ½ã«ã‚ˆã‚Šã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹éš›ã®é–‹ç™ºè€…ã®ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ã‚’æ–°ã—ã„ãƒ¬ãƒ™ãƒ«ã«å¼•ãä¸Šã’ã¾ã™ã€‚

`Prisma Accelerate` ã¯ã€ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ãªã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ¼ãƒ«ã‚’å‚™ãˆãŸã‚°ãƒ­ãƒ¼ãƒãƒ«ãªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã§ã€ã‚¯ã‚¨ãƒªã‚’é«˜é€ŸåŒ–ã—ã¾ã™ã€‚

`Prisma Pulse` ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€åž‹å®‰å…¨ãªãƒ¢ãƒ‡ãƒ«ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®å¤‰æ›´ã«å¯¾å¿œã§ãã¾ã™ã€‚

## Prisma ORM

æ•°åˆ†ã§ Prisma ORM ã‚’ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«è¿½åŠ ã—ã€ãƒ‡ãƒ¼ã‚¿ã®ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã€ã‚¹ã‚­ãƒ¼ãƒžãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®ã‚¯ã‚¨ãƒªã‚’é–‹å§‹ã§ãã¾ã™ã€‚

SQLite ã‚’ä½¿ç”¨ã—ã¦ Prisma ã‚’è©¦ã—ã¦ã¿ã‚ˆã†ï¼

SQLite ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è‡ªä½“ã‚’èµ·å‹•ã•ã›ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

[ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ]()ï¼šSQLite ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½¿ç”¨ã—ã¦ Prisma ORM ã‚’ã‚¼ãƒ­ã‹ã‚‰ 5 åˆ†ã§ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚

[ã‚µãƒ³ãƒ—ãƒ«]()ï¼šãŠæ°—ã«å…¥ã‚Šã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦ã€ã™ãã«å®Ÿè¡Œã§ãã‚‹ã‚µãƒ³ãƒ—ãƒ«ã‚’è©¦ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

## ä»–ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§ã¯ã˜ã‚ã‚‹

Prisma ORM ã‚’ SQLite ä»¥å¤–ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æŽ¥ç¶šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚

# ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

ã“ã®ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆã‚¬ã‚¤ãƒ‰ã§ã¯ã€ãƒ—ãƒ¬ãƒ¼ãƒ³ãª **TypeScript** ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ãƒ­ãƒ¼ã‚«ãƒ«ã® `SQLite` ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã€Prisma ORM ã‚’æœ€åˆã‹ã‚‰ä½¿ã„å§‹ã‚ã‚‹æ–¹æ³•ã‚’å­¦ç¿’ã—ã¾ã™ã€‚**ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒªãƒ³ã‚°**ã€**ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã® **ã‚¯ã‚¨ãƒª** ã«ã¤ã„ã¦èª¬æ˜Žã—ã¾ã™ã€‚

PostgreSQLã€MySQLã€MongoDBã€ãã®ä»–ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§ Prisma ORM ã‚’ä½¿ç”¨ã—ãŸã„å ´åˆã¯ä»¥ä¸‹ã‚’ã”è¦§ãã ã•ã„ã€‚

- Prisma ORM ã‚’ã‚¼ãƒ­ã‹ã‚‰å§‹ã‚ã‚‹
- æ—¢å­˜ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã« Prisma ORM ã‚’è¿½åŠ ã™ã‚‹

å‹•ä½œè¦ä»¶

ã“ã®ã‚¬ã‚¤ãƒ‰ã«ã¯ Node.js v16.13.0 ä»¥ä¸ŠãŒå¿…è¦ã§ã™ï¼ˆã‚·ã‚¹ãƒ†ãƒ è¦ä»¶ã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€ã“ã¡ã‚‰ã‚’ã”è¦§ãã ã•ã„ï¼‰ã€‚

## 1. TypeScript ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆã¨ Prisma ORM ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

æœ€åˆã®ã‚¹ãƒ†ãƒƒãƒ—ã¨ã—ã¦ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã€ãã“ã«ç§»å‹•ã—ã¾ã™ã€‚

```shell
mkdir hello-prisma
cd hello-prisma
```

æ¬¡ã«ã€npm ã‚’ä½¿ç”¨ã—ã¦ TypeScript ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’åˆæœŸåŒ–ã—ã¾ã™ã€‚

```shell
npm init -y
npm install typescript ts-node @types/node --save-dev
```

ã“ã‚Œã«ã‚ˆã‚Šã€TypeScript ã‚¢ãƒ—ãƒªã®åˆæœŸè¨­å®šã‚’å«ã‚€ `package.json` ãŒä½œæˆã•ã‚Œã¾ã™ã€‚

> [!NOTE]
> åˆ¥ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒžãƒãƒ¼ã‚¸ãƒ£ã‚’ä½¿ç”¨ã—ã¦ Prisma ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ã¯ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

æ¬¡ã«ã€TypeScript ã‚’åˆæœŸåŒ–ã—ã¾ã™ã€‚

```shell
npx tsc --init
```

æ¬¡ã«ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®é–‹ç™ºä¾å­˜é–¢ä¿‚ã¨ã—ã¦ Prisma CLI ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

```shell
npm install prisma --save-dev
```

æœ€å¾Œã«ã€Prisma CLI ã® `init` ã‚³ãƒžãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ Prisma ORM ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚

```shell
npx prisma init --datasource-provider sqlite
```

ã“ã‚Œã«ã‚ˆã‚Šã€æ–°ã—ã„ `prisma` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨ `prisma.schema` ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ã—ã¦ SQLite ãŒè¨­å®šã•ã‚Œã¾ã™ã€‚ã“ã‚Œã§ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ¢ãƒ‡ãƒ«åŒ–ã—ã€ã„ãã¤ã‹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æŒã¤ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆã™ã‚‹æº–å‚™ãŒã§ãã¾ã—ãŸã€‚

## 2. Prisma ã‚¹ã‚­ãƒ¼ãƒžã§ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ¢ãƒ‡ãƒ«åŒ–ã™ã‚‹

Prisma ã‚¹ã‚­ãƒ¼ãƒžã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ¢ãƒ‡ãƒ«åŒ–ã™ã‚‹ç›´æ„Ÿçš„ãªæ–¹æ³•ã‚’æä¾›ã—ã¾ã™ã€‚æ¬¡ã®ãƒ¢ãƒ‡ãƒ«ã‚’ `schema.prisma` ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ ã—ã¾ã™ã€‚

`prisma/schema.prisma`

```prisma
model User {
  id    Int     @id @default(autoincrement())
  email String  @unique
  name  String?
  posts Post[]
}

model Post {
  id        Int     @id @default(autoincrement())
  title     String
  content   String?
  published Boolean @default(false)
  author    User    @relation(fields: [authorId], references: [id])
  authorId  Int
}
```

Prisma ã‚¹ã‚­ãƒ¼ãƒžã®ãƒ¢ãƒ‡ãƒ«ã«ã¯ã€ä¸»ã«ï¼’ã¤ã®ç›®çš„ãŒã‚ã‚Šã¾ã™ã€‚

- åŸºç¤Žã¨ãªã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å†…ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¡¨ã™
- ç”Ÿæˆã•ã‚ŒãŸ Prisma ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ API ã®åŸºç›¤ã¨ã—ã¦æ©Ÿèƒ½ã™ã‚‹

æ¬¡ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€Prisma Migrate ã‚’ä½¿ç”¨ã—ã¦ã“ã‚Œã‚‰ã®ãƒ¢ãƒ‡ãƒ«ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒžãƒƒãƒ”ãƒ³ã‚°ã—ã¾ã™ã€‚

## 3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆã®ãŸã‚ Prisma Migrate ã§ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œ

ã“ã®æ™‚ç‚¹ã§ã¯ã€Prisma ã‚¹ã‚­ãƒ¼ãƒžã¯ã‚ã‚Šã¾ã™ãŒã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“ã€‚ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§æ¬¡ã®ã‚³ãƒžãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã€SQLite ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ã€ãƒ¢ãƒ‡ãƒ«ã§è¡¨ã•ã‚Œã‚‹ `User` ã¨ `Post` ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

```shell
npx prisma migrate dev --name init
```

ã“ã®ã‚³ãƒžãƒ³ãƒ‰ã¯æ¬¡ã®ï¼“ã¤ã®ã“ã¨ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

1. ã“ã®ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã®æ–°ã—ã„ SQL ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ `prisma/migrations` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä½œæˆã—ã¾ã™
1. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«å¯¾ã—ã¦ SQL ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œã—ã¾ã™
1. å†…éƒ¨ã§ `prisma generate` ã‚’å®Ÿè¡Œã—ã¾ã™ï¼ˆã“ã‚Œã«ã‚ˆã‚Š `@prisma/client` ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã€ãƒ¢ãƒ‡ãƒ«ã«åŸºã¥ã„ã¦ã‚«ã‚¹ã‚¿ãƒžã‚¤ã‚ºã•ã‚ŒãŸ Prisma Client API ãŒç”Ÿæˆã•ã‚Œã¾ã™ï¼‰

SQLite ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ãŒãªã„ãŸã‚ `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã®ç’°å¢ƒå¤‰æ•°ã§å®šç¾©ã•ã‚ŒãŸ `dev.db` ã¨ã„ã†åå‰ã§ `prisma` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã«ä½œæˆã•ã‚Œã¾ã™ã€‚

ã“ã‚Œã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®æº–å‚™ãŒã§ãã¾ã—ãŸã€‚ãã‚Œã§ã¯ã€ã©ã®ã‚ˆã†ã«ã‚¯ã‚¨ãƒªã‚’é€ä¿¡ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿æ›¸ãã§ãã‚‹ã‹ã‚’å­¦ã³ã¾ã—ã‚‡ã†ï¼

## 4. Prisma Client ã‚’ä½¿ç”¨ã—ãŸãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®ã‚¯ã‚¨ãƒªé€ä¿¡æ–¹æ³•

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚¯ã‚¨ãƒªã‚’é€ä¿¡ã™ã‚‹ã«ã¯ã€Prisma Client ã®ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã® TypeScript ãƒ•ã‚¡ã‚¤ãƒ«ãŒå¿…è¦ã§ã™ã€‚ã“ã®ãŸã‚ã« script.ts ã¨ã„ã†æ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

```shell
touch script.ts
```

æ¬¡ã«ã€æ¬¡ã®å®šåž‹æ–‡ã‚’è²¼ã‚Šä»˜ã‘ã¾ã™ã€‚

`script.ts`

```ts
import { PrismaClient } from '@prisma/client'

const prisma = new PrismaClient()

async function main() {
  // ... you will write your Prisma Client queries here
}

main()
  .then(async () => {
    await prisma.$disconnect()
  })
  .catch(async (e) => {
    console.error(e)
    await prisma.$disconnect()
    process.exit(1)
  })
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã«ã¯ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æœ€å¾Œã«å‘¼ã³å‡ºã•ã‚Œã‚‹ `main` é–¢æ•°ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚ã¾ãŸã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®ã‚¯ã‚¨ãƒªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚’è¡¨ã™ `PrismaClient` ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚

### 4.1. æ–°ã—ã„ `User` ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ä½œæˆ

ã¾ãšã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ–°ã—ã„ `User` ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã€çµæžœã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ãƒ­ã‚°å‡ºåŠ›ã™ã‚‹å°ã•ãªã‚¯ã‚¨ãƒªã‹ã‚‰å§‹ã‚ã¾ã—ã‚‡ã†ã€‚æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’ `script.ts` ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ ã—ã¾ã™ã€‚

`script.ts`

```diff
  import { PrismaClient } from '@prisma/client'

  const prisma = new PrismaClient()

  async function main() {
+   const user = await prisma.user.create({
+     data: {
+       name: 'Alice',
+       email: 'alice@prisma.io',
+     },
+   })
+   console.log(user)
  }

  main()
    .then(async () => {
      await prisma.$disconnect()
    })
    .catch(async (e) => {
      console.error(e)
      await prisma.$disconnect()
      process.exit(1)
    })
```

ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹ä»£ã‚ã‚Šã«ã€ã‚¨ãƒ‡ã‚£ã‚¿ã§ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€Prisma ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒæä¾›ã™ã‚‹ã‚ªãƒ¼ãƒˆã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆã‚’ä½“é¨“ã§ãã¾ã™ã€‚ã¾ãŸã€ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã® `CTRL` + `SPACE` ã‚­ãƒ¼ã‚’æŠ¼ã™ã“ã¨ã§ã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ã‚ªãƒ¼ãƒˆã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆã‚’å‘¼ã³å‡ºã™ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

æ¬¡ã«ã€ä»¥ä¸‹ã®ã‚³ãƒžãƒ³ãƒ‰ã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```shell
npx ts-node script.ts
```

ã“ã‚Œã§ã€Prisma Client ã§æœ€åˆã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒä½œæˆã•ã‚Œã¾ã—ãŸï¼ðŸŽ‰

æ¬¡ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿å–ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã™ã€‚

### 4.2. ã™ã¹ã¦ã® `User` ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—

Prisma Client ã«ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€ãŸã‚ã®ã•ã¾ã–ã¾ãªã‚¯ã‚¨ãƒªãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€æŒ‡å®šã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å†…ã®ã™ã¹ã¦ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’è¿”ã™ `findMany` ã‚¯ã‚¨ãƒªã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

ä»¥å‰ã® Prisma Client ã‚¯ã‚¨ãƒªã‚’å‰Šé™¤ã—ã€ä»£ã‚ã‚Šã«æ–°ã—ã„ `findMany` ã‚¯ã‚¨ãƒªã‚’è¿½åŠ ã—ã¾ã™ã€‚

`script.ts`

```diff
  import { PrismaClient } from '@prisma/client'

  const prisma = new PrismaClient()

  async function main() {
+   const users = await prisma.user.findMany()
+   console.log(users)
  }

  main()
    .then(async () => {
      await prisma.$disconnect()
    })
    .catch(async (e) => {
      console.error(e)
      await prisma.$disconnect()
      process.exit(1)
    })
```

ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å†åº¦å®Ÿè¡Œã—ã¾ã™ã€‚

```shell
npx ts-node script.ts
```

ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã€å˜ä¸€ã® `User` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒè§’æ‹¬å¼§ã§å›²ã¾ã‚Œã¦ã„ã‚‹ã“ã¨ã«æ³¨ç›®ã—ã¦ãã ã•ã„ã€‚ã“ã‚Œã¯ã€`findMany` ãŒé…åˆ—ã®ä¸­ã«ï¼‘ã¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã—ãŸãŸã‚ã§ã™ã€‚

### 4.3. Prisma Client ã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¯ã‚¨ãƒª

Prisma Client ã®ä¸»ãªæ©Ÿèƒ½ã®ï¼‘ã¤ã¯ã€[relations]() ã‚’ç°¡å˜ã«æ“ä½œã§ãã‚‹ã“ã¨ã§ã™ã€‚ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€ãƒã‚¹ãƒˆã•ã‚ŒãŸæ›¸ãè¾¼ã¿ã‚¯ã‚¨ãƒªã§ `User` ãƒ¬ã‚³ãƒ¼ãƒ‰ã¨ `Post` ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã™ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã™ã€‚ãã®å¾Œã€`include` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å–å¾—ã™ã‚‹æ–¹æ³•ã‚’èª¬æ˜Žã—ã¾ã™ã€‚

ã¾ãšã€ãƒã‚¹ãƒˆã•ã‚ŒãŸã‚¯ã‚¨ãƒªã‚’å«ã‚ã‚‹ã‚ˆã†ã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’èª¿æ•´ã—ã¾ã™ã€‚

`script.ts`

```diff
  import { PrismaClient } from '@prisma/client'

  const prisma = new PrismaClient()

  async function main() {
+   const user = await prisma.user.create({
+     data: {
+       name: 'Bob',
+       email: 'bob@prisma.io',
+       posts: {
+         create: [
+           {
+             title: 'Hello World',
+             published: true
+           },
+           {
+             title: 'My second post',
+             content: 'This is still a draft'
+           }
+         ],
+       },
+     },
+   })
+   console.log(user)
  }

  main()
    .then(async () => {
      await prisma.$disconnect()
    })
    .catch(async (e) => {
      console.error(e)
      await prisma.$disconnect()
      process.exit(1)
    })
```

ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å†åº¦å®Ÿè¡Œã—ã¦ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```shell
npx ts-node script.ts
```

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€Prisma Client ã¯ã‚¯ã‚¨ãƒªã®çµæžœã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã‚¹ã‚«ãƒ©ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿ã‚’è¿”ã—ã¾ã™ã€‚ãã®ãŸã‚ã€æ–°ã—ã„ `User` ãƒ¬ã‚³ãƒ¼ãƒ‰ã«å¯¾ã—ã¦æ–°ã—ã„ `Post` ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ã‚‚ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ã¯ `id`ã€`email`ã€`name` ã®ï¼“ã¤ã®ã‚¹ã‚«ãƒ©ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æŒã¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã¿ãŒå‡ºåŠ›ã•ã‚Œã¾ã—ãŸã€‚

`User` ã«å±žã™ã‚‹ `Post` ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚‚å–å¾—ã™ã‚‹ã«ã¯ã€`posts` ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ä»‹ã—ã¦ `include` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

`script.ts`

```diff
  import { PrismaClient } from '@prisma/client'

  const prisma = new PrismaClient()

  async function main() {
+   const usersWithPosts = await prisma.user.findMany({
+     include: {
+       posts: true,
+     },
+   })
+   console.dir(usersWithPosts, { depth: null })
  }

  main()
    .then(async () => {
      await prisma.$disconnect()
    })
    .catch(async (e) => {
      console.error(e)
      await prisma.$disconnect()
      process.exit(1)
    })
```

ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å†åº¦å®Ÿè¡Œã—ã¦ã€ãƒã‚¹ãƒˆã•ã‚ŒãŸèª­ã¿è¾¼ã¿ã‚¯ã‚¨ãƒªã®çµæžœã‚’ç¢ºèªã—ã¾ã™ã€‚

```shell
npx ts-node script.ts
```

ä»Šå›žã¯ã€ï¼’ã¤ã® `User` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ã©ã¡ã‚‰ã‚‚ `posts` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆ"`Alice`" ã®å ´åˆã¯ç©ºã§ã€"`Bob`" ã®å ´åˆã¯1ã¤ã® `Post` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ï¼‰ã‚’æŒã£ã¦ãŠã‚Šã€ã“ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒ `Post` ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚

`usersWithPosts` é…åˆ—å†…ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚‚å®Œå…¨ã«åž‹æŒ‡å®šã•ã‚Œã¦ã„ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ã“ã‚Œã¯ã‚ªãƒ¼ãƒˆã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆï¼ˆè‡ªå‹•è£œå®Œï¼‰ãŒè¡Œã‚ã‚Œã€TypeScript ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒèª¤ã£ã¦ã‚¿ã‚¤ãƒ—ã—ã¦ã—ã¾ã†ã“ã¨ã‚’é˜²ã„ã§ãã‚Œã¾ã™ã€‚

## 5. æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

ã“ã®ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆã‚¬ã‚¤ãƒ‰ã§ã¯ã€ãƒ—ãƒ¬ãƒ¼ãƒ³ãª TypeScript ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ Prisma ORM ã‚’ä½¿ã„å§‹ã‚ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã—ãŸã€‚ä¾‹ãˆã°ã€`findMany` ã‚¯ã‚¨ãƒªã«ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã€ã‚½ãƒ¼ãƒˆã€ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã—ãŸã‚Šã€`update` ã‚¯ã‚¨ãƒªã‚„ `delete` ã‚¯ã‚¨ãƒªã®ã‚ˆã†ãªæ“ä½œã‚’è¿½åŠ ã—ãŸã‚Šã™ã‚‹ã“ã¨ã§è‡ªç”±ã« Prisma Client API ã‚’ã‚ˆã‚ŠæŽ¢æ±‚ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### Prisma Studio ã§ã®ãƒ‡ãƒ¼ã‚¿å–ã‚Šæ‰±ã„

Prisma ORM ã«ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å†…ã®ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºãŠã‚ˆã³ç·¨é›†ã™ã‚‹ãŸã‚ã® GUI ãŒçµ„ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã™ã€‚æ¬¡ã®ã‚³ãƒžãƒ³ãƒ‰ã§é–‹ãã“ã¨ãŒã§ãã¾ã™ã€‚

```
npx prisma studio
```

### ç‹¬è‡ªã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§ Prisma ORM ã‚’è¨­å®š

ç‹¬è‡ªã® PostgreSQLã€MySQLã€MongoDBã€ã¾ãŸã¯ãã®ä»–ã®ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½¿ç”¨ã—ã¦ Prisma ORM ã‚’é€²ã‚ãŸã„å ´åˆã¯ã€Prisma ORM ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰ã«å¾“ã£ã¦ãã ã•ã„ã€‚

- [Prisma ORM ã‚’ã‚¼ãƒ­ã‹ã‚‰å§‹ã‚ã‚‹]()
- [æ—¢å­˜ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã« Prisma ORM ã‚’è¿½åŠ ã™ã‚‹]()

### ã™ãã«å®Ÿè¡Œã§ãã‚‹ Prisma ORM ã®ä¾‹ã‚’èª¿ã¹ã‚‹

GitHub ã® [`prisma-examples`]() ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã€Prisma ORM ã‚’ãŠæ°—ã«å…¥ã‚Šã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã©ã®ã‚ˆã†ã«ä½¿ç”¨ã§ãã‚‹ã‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚ãƒªãƒã‚¸ãƒˆãƒªã«ã¯ã€Expressã€NestJSã€GraphQL ã®ä¾‹ã‚„ã€Next.js ã¨ Vue.js ã‚’ä½¿ç”¨ã—ãŸãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯ã®ä¾‹ãªã©ã€ã•ã¾ã–ã¾ãªä¾‹ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

### Prisma ORM ã§ã‚¢ãƒ—ãƒªã‚’æ§‹ç¯‰ã™ã‚‹

Prisma ãƒ–ãƒ­ã‚°ã«ã¯ Prisma ORM ã«é–¢ã™ã‚‹åŒ…æ‹¬çš„ãªãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ãŒæŽ²è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚æœ€æ–°ã®ã‚‚ã®ã‚’ã”è¦§ãã ã•ã„ã€‚

- [Next.js ã§ãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯ã‚¢ãƒ—ãƒªã‚’æ§‹ç¯‰ã™ã‚‹]()
- [Remix ã§ãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯ã‚¢ãƒ—ãƒªã‚’æ§‹ç¯‰ã™ã‚‹]() (5 éƒ¨æ§‹æˆã€å‹•ç”»ã‚’å«ã‚€)
- [NestJS ã§ REST API ã‚’æ§‹ç¯‰ã™ã‚‹]()

### Prisma ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã«å‚åŠ ã—ã¾ã—ã‚‡ã† ðŸ’š

Prisma ã«ã¯ã€é–‹ç™ºè€…ã®å·¨å¤§ãª [ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£]() ãŒã‚ã‚Šã¾ã™ã€‚[Discord]() ã«å‚åŠ ã™ã‚‹ã‹ã€[GitHub Discussions]() ã‚’ä½¿ç”¨ã—ã¦è³ªå•ã—ã¦ãã ã•ã„ã€‚

# Prisma ORM ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

æœ€åˆã‹ã‚‰å§‹ã‚ã‚‹ã‹ã€æ—¢å­˜ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã« Prisma ORM ã‚’è¿½åŠ ã—ã¾ã™ã€‚æ¬¡ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§ã¯ã€Prisma CLIã€Prisma Clientã€ãŠã‚ˆã³ Prisma Migrate ã«ã¤ã„ã¦èª¬æ˜Žã—ã¾ã™ã€‚

# ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒŠãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹

Prisma ORM ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æŽ¥ç¶šã—ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã® Prisma Client ã‚’ç”Ÿæˆã—ã¦ã€æ–°ã—ã„ Node.js ã¾ãŸã¯ TypeScript ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚¼ãƒ­ã‹ã‚‰ä½œæˆã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚æ¬¡ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§ã¯ã€[Prisma CLI]()ã€[Prisma Client]()ã€[Prisma Migrate]() ã«ã¤ã„ã¦èª¬æ˜Žã—ã¾ã™ã€‚

## å‰ææ¡ä»¶

ã“ã®ã‚¬ã‚¤ãƒ‰ã‚’å®Œäº†ã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚‚ã®ãŒå¿…è¦ã§ã™ã€‚

- [Node.js]() ã‚’ãƒžã‚·ãƒ³ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã§ã‚ã‚‹ã“ã¨
- [PostgreSQL]() ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µãƒ¼ãƒãŒç¨¼åƒã—ã¦ã„ã‚‹ã“ã¨

> æ­£ç¢ºãªãƒãƒ¼ã‚¸ãƒ§ãƒ³è¦ä»¶ã«ã¤ã„ã¦ã¯ã€[ã‚·ã‚¹ãƒ†ãƒ è¦ä»¶]() ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã® [æŽ¥ç¶š URL]() ãŒæ‰‹å…ƒã«ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µãƒ¼ãƒãƒ¼ã‚’å®Ÿè¡Œã—ã¦ãŠã‚‰ãšã€Prisma ORM ã‚’è©¦ã—ã¦ã¿ãŸã„ã ã‘ã®å ´åˆã¯ã€[ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ]() ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®šã®ä½œæˆ

æœ€åˆã®ã‚¹ãƒ†ãƒƒãƒ—ã¨ã—ã¦ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã€ãã“ã«ç§»å‹•ã—ã¾ã™ã€‚

```shell
mkdir hello-prisma
cd hello-prisma
```

æ¬¡ã«ã€TypeScript ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’åˆæœŸåŒ–ã—ã€Prisma CLI ã‚’é–‹ç™ºä¾å­˜ã¨ã—ã¦è¿½åŠ ã—ã¾ã™ã€‚

```shell
npm init -y
npm install prisma typescript ts-node @types/node --save-dev
```

ã“ã‚Œã«ã‚ˆã‚Šã€TypeScript ã‚¢ãƒ—ãƒªã®åˆæœŸè¨­å®šã‚’å«ã‚€ `package.json` ãŒä½œæˆã•ã‚Œã¾ã™ã€‚

æ¬¡ã«ã€TypeScript ã‚’åˆæœŸåŒ–ã—ã¾ã™ã€‚

```shell
npx tsc --init
```

> [!NOTE]
> åˆ¥ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒžãƒãƒ¼ã‚¸ãƒ£ã‚’ä½¿ç”¨ã—ã¦ Prisma ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ã¯ã€[ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †]() ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

`npx` ã‚’ä»˜ã‘åŠ ãˆã¦ Prisma CLI ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚

```shell
npx prisma
```

æ¬¡ã«ã€æ¬¡ã®ã‚³ãƒžãƒ³ãƒ‰ã§ [Prisma Schema]() ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€Prisma ORM ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’è¨­å®šã—ã¾ã™ã€‚

```shell
npx prisma init
```

ã“ã®ã‚³ãƒžãƒ³ãƒ‰ã¯æ¬¡ã®ï¼’ã¤ã®ã“ã¨ã‚’è¡Œã„ã¾ã™ã€‚

- `prisma` ã¨ã„ã†æ–°ã—ã„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã™ã€‚ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æŽ¥ç¶šå¤‰æ•°ã¨ã‚¹ã‚­ãƒ¼ãƒžãƒ¢ãƒ‡ãƒ«ã‚’è¨˜è¿°ã—ãŸ Prisma ã‚¹ã‚­ãƒ¼ãƒžã‚’å«ã‚€ `schema.prisma` ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ãŒå«ã¾ã‚Œã¾ã™ã€‚
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã« [`.env` ãƒ•ã‚¡ã‚¤ãƒ«]() ã‚’ä½œæˆã—ã¾ã™ã€‚ã“ã‚Œã¯ç’°å¢ƒå¤‰æ•°ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æŽ¥ç¶šãªã©ï¼‰ã‚’å®šç¾©ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

# Connect your database

To connect your database, you need to set the url field of the datasource block in your Prisma schema to your database [connection URL]():

`prisma/schema.prisma`

```prisma
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}
```

In this case, the `url` is [set via an environment variable]() which is defined in .env:

`.env`

```json
DATABASE_URL="postgresql://johndoe:randompassword@localhost:5432/mydb?schema=public"
```

> [!note]
> We recommend adding `.env` to your `.gitignore` file to prevent committing your environment variables.

You now need to adjust the connection URL to point to your own database.

The [format of the connection URL]() for your database depends on the database you use. For PostgreSQL, it looks as follows (the parts spelled all-uppercased are placeholders for your specific connection details):

```json
postgresql://USER:PASSWORD@HOST:PORT/DATABASE?schema=SCHEMA
```

Here's a short explanation of each component:

- `USER`: The name of your database user
- `PASSWORD`: The password for your database user
- `HOST`: The name of your host name (for the local environment, it is localhost)
- `PORT`: The port where your database server is running (typically 5432 for PostgreSQL)
- `DATABASE`: The name of the [database]()
- `SCHEMA`: The name of the [schema]() inside the database

If you're unsure what to provide for the `schema` parameter for a PostgreSQL connection URL, you can probably omit it. In that case, the default schema name `public` will be used.

As an example, for a PostgreSQL database hosted on Heroku, the [connection URL]() might look similar to this:

`.env`

```json
DATABASE_URL="postgresql://opnmyfngbknppm:XXX@ec2-46-137-91-216.eu-west-1.compute.amazonaws.com:5432/d50rgmkqi2ipus?schema=hello-prisma"
```

When running PostgreSQL locally on macOS, your user and password as well as the database name typically correspond to the current user of your OS, e.g. assuming the user is called `janedoe`:

`.env`

```json
DATABASE_URL="postgresql://janedoe:janedoe@localhost:5432/janedoe?schema=hello-prisma"
```
